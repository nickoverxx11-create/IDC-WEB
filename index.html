<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PokÃ©mon AI Adventure</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="zone-navigation">
        <h2 style="margin-bottom: 15px; color: #333;">ğŸ•µğŸ»â€â™‚ï¸ A Quest on Rules and Data</h2>
        <button class="zone-btn active" onclick="switchZone(1)" id="zone1-btn">Zone 1: Clearview Meadow</button>
        <button class="zone-btn" onclick="switchZone(2)" id="zone2-btn" disabled>Zone 2: Azure Coast</button>
        <button class="zone-btn" onclick="switchZone(3)" id="zone3-btn" disabled>Zone 3: Whispering Woods</button>
        <button class="zone-btn" onclick="switchZone(4)" id="zone4-btn" disabled>Zone 4: Sunrise Desert</button>
         <button class="zone-btn" onclick="switchZone(5)" id="zone5-btn" disabled>ğŸ† Zone 5: Guardian's Gate</button>
    </div>

    <div id="zone1" class="zone-container active">
        <h1><span class="emoji">ğŸ•ï¸</span> Zone 1: Clearview Meadow</h1>
        <p class="zone-subtitle">Simple Rules</p>

        <div class="dialogue-box">
            <div class="dialogue-speaker">ğŸ‘¨â€ğŸ”¬ Professor Oak
                 <button class="btn-guide-mini" onclick="openGuidebook()" title="Open Guidebook">ğŸ“– Guide</button>
            </div>
            <div class="dialogue-text">"Welcome to the journey! To help RuleBot identify Fire-types, we must give it clear instructions. Drag your Clue Cards into the slots to build its brain!"</div>
        </div>

    <div class="hint-wrapper">
        <button class="btn-hint" onclick="showNextHint(1)">ğŸ’¡ Need a Hint?</button>
        <div id="zone1-hint-box" class="hint-box">
            <span id="zone1-hint-text"></span>
            <span class="hint-counter" id="zone1-hint-counter"></span>
        </div>
    </div>
    
 <!-- THE INTEGRATED RULES & LED AREA -->
<div class="rules-layout-flex">
    
    <!-- LEFT COLUMN: Rule Slots -->
    <div class="rule-slots-container" id="zone1-slots">
        <div class="rule-slot" ondrop="dropFeature(event, 1, 0)" ondragover="allowDrop(event)">Drop Feature 1</div>
        <div class="rule-slot" ondrop="dropFeature(event, 1, 1)" ondragover="allowDrop(event)">Drop Feature 2</div>
        <div class="rule-slot" ondrop="dropFeature(event, 1, 2)" ondragover="allowDrop(event)">Drop Feature 3</div>
        <div class="rule-slot" ondrop="dropFeature(event, 1, 3)" ondragover="allowDrop(event)">Drop Feature 4</div>
    </div>

    <!-- RIGHT COLUMN: LED Board Slot -->
    <div class="led-slot"> 
        <div class="led-board" id="led-board">
            <div class="compact-led-wrapper">
                <div class="led-header-row">
                    <img src="row.png" class="column-img-wide">
                </div>
                <div class="led-body-row">
                    <img src="column.png" class="row-img-tall">
                    <div id="led-grid-content" class="led-grid-flipped"></div>
                </div>
            </div>
        </div>
    </div>
</div>

        <div class="feature-bank">
            <button class="btn-mini-reset" onclick="resetZone(1)" title="Reset Rules">ğŸ”„ Reset</button>
            <div class="feature-list" id="feature-bank-list-z1"></div>
        </div>

        <!-- STEP 1: STATISTICAL TESTING BLOCK -->
    <div class="test-block-container" id="stats-test-zone1">
        <h3>ğŸ“Š Step 1: The Meadow Trial</h3>
        <p>"Let's see how RuleBot handles a whole field of 100 PokÃ©mon using your rules!"</p>
        <button class="btn-run-stats" onclick="testZone1()">ğŸ§ª Run Experiment (100 Cases)</button>
        <div id="zone1-stats-results" class="stats-mini-results"></div>
    </div>

    <!-- STEP 2: MYSTERY SINGLE TEST (Locked until Step 1 is done) -->
    <div class="single-test-section locked" id="single-test-zone1">
        <h3>ğŸ Step 2: The Mystery Gift Challenge</h3>
        <p>"Wonderful! Now, let's open 3 mystery gifts to see if RuleBot makes the right call every time. Progress: <span id="z1-count">0</span>/3"</p>
        <div class="mystery-box-container" onclick="runSingleTest()">
            <div class="mystery-box"><span>ğŸ</span><br>Open Mystery Box</div>
        </div>
        <div id="single-test-result" class="single-result-panel"></div>
    </div>

    <div class="controls" style="text-align:center;">
        <button class="btn btn-success" onclick="completeZone(1)" id="zone1-complete" style="display: none;">âœ… Lab 1 Complete - Continue</button>
    </div>
    </div>

    <div id="zone2" class="zone-container">
        <h1><span class="emoji">ğŸ–ï¸</span> Zone 2: Azure Coast</h1>
        <p class="zone-subtitle">Multi-Class & Feature Importance</p>

         <div class="dialogue-box">
        <div class="dialogue-speaker">
            ğŸ‘¨â€ğŸ”¬ Professor Oak 
            <button class="btn-guide-mini" onclick="openGuidebook()">ğŸ“– Guide</button>
        </div>
        <div class="dialogue-text">"The Coast is home to many types! We need a Master Plan. Decide which clues are most important for all four types. Remember: the first slot has the most 'weight' in RuleBot's mind!"</div>
    </div>

        <div class="hint-wrapper">
        <button class="btn-hint" onclick="showNextHint(2)">ğŸ’¡ Need a Hint?</button>
        <div id="zone2-hint-box" class="hint-box">
            <span id="zone2-hint-text"></span>
            <span class="hint-counter" id="zone2-hint-counter"></span>
        </div>
        </div>

        <div style="display:flex; justify-content:center; margin-bottom:20px;">
        <div class="led-slot"></div>
    </div>

        <div class="multi-type-grid">
    <!-- Fire -->
    <div class="type-section fire">
        <div class="type-header-row">
            <h3>ğŸ”¥ Fire Rules</h3>
            <button class="btn-mini-reset" onclick="resetZone2Type('fire')" title="Reset Fire Only">â†º</button>
        </div>
        <div class="rule-slots-container">
            <div class="rule-slot" ondrop="dropFeature(event, 2, 0, 'fire')" ondragover="allowDrop(event)"><div class="slot-label">1st (3pts)</div></div>
            <div class="rule-slot" ondrop="dropFeature(event, 2, 1, 'fire')" ondragover="allowDrop(event)"><div class="slot-label">2nd (2pts)</div></div>
            <div class="rule-slot" ondrop="dropFeature(event, 2, 2, 'fire')" ondragover="allowDrop(event)"><div class="slot-label">3rd (2pts)</div></div>
            <div class="rule-slot" ondrop="dropFeature(event, 2, 3, 'fire')" ondragover="allowDrop(event)"><div class="slot-label">4th (1pt)</div></div>
        </div>
    </div>

    <!-- Water -->
    <div class="type-section water">
        <div class="type-header-row">
            <h3>ğŸ’§ Water Rules</h3>
            <button class="btn-mini-reset" onclick="resetZone2Type('water')" title="Reset Water Only">â†º</button>
        </div>
        <div class="rule-slots-container">
            <div class="rule-slot" ondrop="dropFeature(event, 2, 0, 'water')" ondragover="allowDrop(event)"><div class="slot-label">1st (3pts)</div></div>
            <div class="rule-slot" ondrop="dropFeature(event, 2, 1, 'water')" ondragover="allowDrop(event)"><div class="slot-label">2nd (2pts)</div></div>
            <div class="rule-slot" ondrop="dropFeature(event, 2, 2, 'water')" ondragover="allowDrop(event)"><div class="slot-label">3rd (2pts)</div></div>
            <div class="rule-slot" ondrop="dropFeature(event, 2, 3, 'water')" ondragover="allowDrop(event)"><div class="slot-label">4th (1pt)</div></div>
        </div>
    </div>

    <!-- Grass -->
    <div class="type-section grass">
        <div class="type-header-row">
            <h3>ğŸƒ Grass Rules</h3>
            <button class="btn-mini-reset" onclick="resetZone2Type('grass')" title="Reset Grass Only">â†º</button>
        </div>
        <div class="rule-slots-container">
            <div class="rule-slot" ondrop="dropFeature(event, 2, 0, 'grass')" ondragover="allowDrop(event)"><div class="slot-label">1st (3pts)</div></div>
            <div class="rule-slot" ondrop="dropFeature(event, 2, 1, 'grass')" ondragover="allowDrop(event)"><div class="slot-label">2nd (2pts)</div></div>
            <div class="rule-slot" ondrop="dropFeature(event, 2, 2, 'grass')" ondragover="allowDrop(event)"><div class="slot-label">3rd (2pts)</div></div>
            <div class="rule-slot" ondrop="dropFeature(event, 2, 3, 'grass')" ondragover="allowDrop(event)"><div class="slot-label">4th (1pt)</div></div>
        </div>
    </div>

    <!-- Dragon -->
    <div class="type-section dragon">
        <div class="type-header-row">
            <h3>ğŸ‰ Dragon Rules</h3>
            <button class="btn-mini-reset" onclick="resetZone2Type('dragon')" title="Reset Dragon Only">â†º</button>
        </div>
        <div class="rule-slots-container">
            <div class="rule-slot" ondrop="dropFeature(event, 2, 0, 'dragon')" ondragover="allowDrop(event)"><div class="slot-label">1st (3pts)</div></div>
            <div class="rule-slot" ondrop="dropFeature(event, 2, 1, 'dragon')" ondragover="allowDrop(event)"><div class="slot-label">2nd (2pts)</div></div>
            <div class="rule-slot" ondrop="dropFeature(event, 2, 2, 'dragon')" ondragover="allowDrop(event)"><div class="slot-label">3rd (2pts)</div></div>
            <div class="rule-slot" ondrop="dropFeature(event, 2, 3, 'dragon')" ondragover="allowDrop(event)"><div class="slot-label">4th (1pt)</div></div>
        </div>
    </div>
</div>
        <div class="feature-bank">
        <div class="bank-header">
            <h3>ğŸ´ Master Plan Clue Cards</h3>
            <button class="btn-mini-reset" onclick="resetZone(2)">ğŸ”„ Reset</button>
        </div>
        <div class="feature-list" id="feature-bank-list-z2"></div>
    </div>

       <!-- STEP 1: STATISTICAL TESTING -->
    <div class="test-block-container" id="stats-test-zone2">
        <h3>ğŸ“Š Step 1: The Grand Coast Trial</h3>
        <p>"Let's see if your Master Plan can correctly sort every PokÃ©mon on the beach!"</p>
        <button class="btn-run-stats" onclick="testZone2()">ğŸ§ª Test Master Plan (100 Cases)</button>
        <div id="zone2-stats-results" class="stats-mini-results"></div>
    </div>

    <!-- STEP 2: MYSTERY SINGLE TEST (Locked initially) -->
    <div class="single-test-section locked" id="single-test-zone2">
        <h3>ğŸ Step 2: The Final Coast Exam</h3>
        <p>One by one! Let's see how RuleBot calculates its 'Confidence' for these mystery PokÃ©mon. Progress: <span id="z2-count">0</span>/3</p>
        
        <div class="mystery-box-container zone2-box-container" onclick="runSingleTestZone2()">
            <div class="mystery-box"><span>ğŸ</span><br>Open Scoring Box</div>
        </div>

        <div id="single-test-result-zone2" class="single-result-panel"></div>
    </div>

    <div class="controls" style="text-align:center;">
        <button class="btn btn-success" onclick="completeZone(2)" id="zone2-complete" style="display: none;">âœ… Lab 2 Complete - Continue</button>
    </div>
</div>

    <div id="zone3" class="zone-container">
        <h1><span class="emoji">ğŸï¸</span> Zone 3: Whispering Woods</h1>
        <p class="zone-subtitle">Upgrading to DataBot</p>

        <div class="dialogue-box">
            <div class="dialogue-speaker">ğŸ‘¨â€ğŸ”¬ Professor Oak</div>
            <div class="dialogue-text">"Big news, Researchers! RuleBot has been upgraded into <strong>DataBot</strong>. 
            He doesn't need rules anymoreâ€”he learns from patterns! But watch out, Meowth has 
            corrupted some training packages with 'noisy' data. We need to find the clean ones!"</div>
        </div>

        <div class="progress-indicator">
            <strong>Progress:</strong> <span id="zone3-progress">Fire Type (1/4)</span>
            <div class="progress-bar"><div class="progress-fill" id="zone3-progress-bar" style="width: 25%;"></div></div>
        </div>
        <div id="zone3-challenge"></div>
        <div id="zone3-feedback"></div>
        <div class="controls">
            <button class="btn btn-success" onclick="completeZone(3)" id="zone3-complete" style="display: none;">âœ… Continue to Zone 4</button>
        </div>
    </div>

    <div id="zone4" class="zone-container">
        <h1><span class="emoji">ğŸœï¸</span> Zone 4: Sunrise Desert</h1>
        <p class="zone-subtitle">Training Strategy</p>

        <div class="dialogue-box">
            <div class="dialogue-speaker">ğŸ‘¨â€ğŸ”¬ Professor Oak</div>
            <div class="dialogue-text">"To cross this desert, DataBot needs a balanced mind. You can only carry <strong>4 packages</strong> 
            in your backpack."</div>
        </div>

        <div class="hint-wrapper">
        <button class="btn-hint" onclick="showNextHint(4)">ğŸ’¡ Need a Hint?</button>
        <div id="zone4-hint-box" class="hint-box">
            <span id="zone4-hint-text"></span>
            <span class="hint-counter" id="zone4-hint-counter"></span>
        </div>
        </div>

        <div class="led-slot"></div>

        <div class="dataset-selection">
            <h3 style="text-align: center; margin-bottom: 20px;">ğŸ“¦ Packages (Select exactly 4)</h3>
            <p style="text-align: center; color: #666; margin-bottom: 20px;"><strong>Selected: <span id="selected-count">0</span> / 4</strong></p>
            <div class="dataset-cards" id="zone4-dataset-cards"></div>
        </div>
        <div class="controls">
            <button class="btn btn-success" onclick="trainZone4()" id="zone4-train" disabled>ğŸš€ Train AI & See Weights</button>
            <button class="btn btn-danger" onclick="resetZone(4)">ğŸ”„ Reset Selection</button>
        </div>
        <div class="results-panel" id="zone4-results"></div>

         <div class="single-test-section" id="zone4-single-test" style="display:none;">
        <h3>ğŸ”® Test Your Trained AI</h3>
        <p style="text-align:center; color:#666; margin-bottom:15px;">
            Your AI has learned "weights" from the packages you selected. <br>
            Click the box to see how it calculates a <strong>Confidence Score</strong> for a random PokÃ©mon!
        </p>
        
        <div class="mystery-box-container zone4-box-container" onclick="runSingleTestZone4()">
            <div class="mystery-box">
                <span style="font-size: 3em;">ğŸ¤–</span><br>
                Ask DataBot
            </div>
        </div>

        <!-- The Result Display -->
        <div id="single-test-result-zone4" class="single-result-panel">
            <!-- Content injected via JS -->
        </div>
    </div>

     <div class="controls">
        <button class="btn btn-success" onclick="completeJourney()" id="zone4-complete" style="display: none;">ğŸ‰ Complete Journey</button>
    </div>
    </div>

    <div id="zone5" class="zone-container">
    <h1>ğŸ† Zone 5: The Guardian's Gate</h1>
    <p class="zone-subtitle">Human Logic (Rules) vs. AI Logic (Data)</p>

    <div class="dialogue-box">
        <div class="dialogue-speaker">ğŸ‘¨â€ğŸ”¬ Professor Oak</div>
        <div class="dialogue-text">
            "This is it! Three powerful Guardians block the path. 
            <strong>RuleBot</strong> uses the rules RuleBot learned in Zone 2. 
            <strong>DataBot</strong> uses the patterns DataBot learned in Zone 4.
            They might disagree... You must decide which bot to trust for each Guardian!"
        </div>
    </div>

    <div id="boss-battle-area" style="display:none;">
        
        <!-- The Boss Card -->
        <div class="boss-section">
            <div class="boss-card">
                <div style="font-size:4em;">ğŸ‘º</div>
                <h2 id="boss-name">Guardian 1</h2>
                <div class="stats-grid-small" id="boss-stats-display">
                    <!-- Stats injected here -->
                </div>
            </div>
        </div>

        <!-- The Bots -->
        <div class="bots-comparison">
            
            <!-- RuleBot (Rules) -->
            <div class="bot-card RuleBot">
                <div class="bot-icon">ğŸ¤–</div>
                <h3>RuleBot</h3>
                <p class="bot-subtitle">Rule-Based System</p>
                <div class="bot-thinking" id="RuleBot-reasoning">Analyzing rules...</div>
                <div class="bot-prediction" id="RuleBot-prediction">...</div>
                <button class="btn btn-primary" onclick="trustBot('RuleBot')">Trust RuleBot</button>
            </div>

            <!-- VS Badge -->
            <div class="vs-badge">VS</div>

            <!-- DataBot (ML) -->
            <div class="bot-card DataBot">
                <div class="bot-icon">ğŸ¦–</div>
                <h3>DataBot</h3>
                <p class="bot-subtitle">Trained Model</p>
                <div class="bot-thinking" id="DataBot-reasoning">Calculating weights...</div>
                <div class="bot-prediction" id="DataBot-prediction">...</div>
                <button class="btn btn-success" onclick="trustBot('DataBot')">Trust DataBot</button>
            </div>

        </div>
    </div>

    <div id="zone5-feedback" class="feedback" style="display:none; margin-top:20px;"></div>

    <div class="controls">
        <button class="btn btn-primary" id="start-boss-btn" onclick="startBossBattle()">âš”ï¸ Summon Guardian 1</button>
        <button class="btn btn-primary" id="next-boss-btn" onclick="nextBoss()" style="display:none;">âš”ï¸ Next Guardian</button>
    </div>
</div> 

<!-- Guidebook Modal (Carousel Version) -->
<div id="guidebook-modal" class="modal">
    <div class="modal-content guidebook-container">
        <span class="close-modal" onclick="closeGuidebook()">&times;</span>
        
        <div class="guidebook-viewer">
            <!-- Left Button -->
            <button class="nav-btn prev-btn" onclick="changeGuidePage(-1)">&#10094;</button>
            
            <!-- Image Area -->
            <div class="guide-display">
                <h2 id="guide-title">ğŸ”¥ Fire Type Analysis</h2>
                
                <!-- The Image -->
                <div class="guide-image-wrapper">
                    <img id="guide-img" src="fire.png" alt="Guidebook Page">
                </div>
                
                <p id="guide-page-num">Page 1 of 4</p>
            </div>

            <!-- Right Button -->
            <button class="nav-btn next-btn" onclick="changeGuidePage(1)">&#10095;</button>
        </div>
    </div>
</div>

    <!-- Scripts -->
    <script src="loader.js"></script>
    <script src="main.js"></script>
</body>
</html>